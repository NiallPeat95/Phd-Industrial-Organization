---
author: Matteo Courthoud
bibliography: references.bib
date: 2021-10-29
link-citations: true
output:
  html_notebook:
    toc: true
    toc_depth: 2
  ioslides_presentation:
    css: custom.css
    slide_level: 3
    smaller: true
    transition: 0
    widescreen: true
  md_document:
    preserve_yaml: true
    variant: markdown_mmd
title: "Coding: BLP (1995)"
type: book
weight: 12
---

### Intro

In this session, I am going to cover demand estimation.

-   Compute equilibrium outcomes with RCL demand
-   Simulate market-level data
    -   Extremely similar to the logit demand simulation
-   Build the BLP estimator from Berry, Levinsohn, and Pakes
    ([1995](#ref-berry1995automobile))

### Model

In this first part, we are going to assume that consumer
$i \in \lbrace1,...,I\rbrace$ utility from good
$j \in \lbrace1,...,J\rbrace$ in market $t \in \lbrace1,...,T\rbrace$
takes the form

$$
u_{ijt} = \boldsymbol x_{jt} \boldsymbol \beta_{it} - \alpha p_{jt} + \xi_{jt} + \epsilon_{ijt}
$$

where

-   $\xi_{jt}$ is type-1 extreme value distributed
-   $\boldsymbol \beta_{it}$: has dimension $K$
    $$\beta_{it}^k = \beta_0^k + \sigma_k \zeta_{it}^k$$
    -   $\beta_0^k$: fixed taste for characteristic $k$ (the usual
        $\beta$)
    -   $\zeta_{it}^k$: random taste, i.i.d. across consumers and
        markets $t$

### Setup

We have $J$ firms and each product has $K$ characteristics.

``` julia
J = 3;                  # 3 firms == products
```

    ## 3

``` julia
K = 2;                  # 2 product characteristics
```

    ## 2

``` julia
c = rand(J);            # Random uniform marginal costs
```

    ## 3-element Array{Float64,1}:
    ##  0.0834350953662395
    ##  0.466464443285586
    ##  0.8601267950375191

``` julia
xi = randn(J+1);        # Random normal individual shocks
```

    ## 4-element Array{Float64,1}:
    ##   0.7636093422596191
    ##  -0.6311649409777343
    ##   0.2538569743657865
    ##  -0.09613131611424358

``` julia
X = randexp(J, K);      # Random exponential product characteristics
```

    ## 3×2 Array{Float64,2}:
    ##  0.243242  1.89201
    ##  0.401695  0.236917
    ##  1.18138   0.261039

``` julia
b = [ones(K); -1]       # Unitary preferences (also for prices)
```

    ## 3-element Array{Float64,1}:
    ##   1.0
    ##   1.0
    ##  -1.0

## References

------------------------------------------------------------------------

<div id="refs" class="references csl-bib-body hanging-indent"
markdown="1">

<div id="ref-berry1995automobile" class="csl-entry" markdown="1">

Berry, Steven, James Levinsohn, and Ariel Pakes. 1995. “Automobile
Prices in Market Equilibrium.” *Econometrica: Journal of the Econometric
Society*, 841–90.

</div>

</div>
